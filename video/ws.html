<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
<input type="text" value="127.0.0.1" id="address">
<input type="button" onclick="my_click()" value="开始">
<img id="img" src="#" alt="图片没过来">
<script>
    var address = "127.0.0.1";

    var client = new WebSocket('ws://' + address + ':9092');

    var img = document.getElementById('img');

    var str = "";

    var i = 0;

    function my_click() {
        var text = document.getElementById('address');
        address = text.value;
        client = new WebSocket('ws://' + address + ':9092');
    }
    client.open = function () {
        console.log('open');
    }

    client.onmessage = function (e) {
        if (e.data == 'start') {
            str = "";
        } else if (e.data != 'end') {
            str += e.data;
        } else if (e.data == 'end') {
            img.src = str;
            console.log(str);
        }
        console.log("#" + i + " " + e.data);
        i++;
    }

    client.onclose = function () {
        console.log("WebSocketClosed!");
    }

    client.onerror = function (evt) {
        console.log(evt.data);
    }
</script>
</body>
</html>